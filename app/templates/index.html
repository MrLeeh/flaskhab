{% extends "base.html" %}


{% block scripts %}
{{ super() }}
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<script>
  $(document).ready(function() {
    var socket = io.connect('http://' + document.domain + ':' + location.port);

    socket.on('mqtt_message', function(data) {
      $row = $('#mqtt-item-' + data.id);
      $row.find('.mqtt-item-value').val(data.value);
      console.log(data);
    });
  });
</script>
{% endblock %}


{% block content %}
<div class="container">
  <div class="row">
    <div class="col-xs-12 col-sm-6">
      {% for panel in panels %}
      <div class="panel panel-default">
        <div class="panel-heading">
          {{ panel.title }}
        </div>
        <div class="panel-body">
          <div class="form-horizontal">
            {% for item in panel.items %}
            <div class="form-group" id="mqtt-item-{{ item.id }}">
              <label class="control-label col-sm-6">{{ item.name }}:</label>
              <div class="col-sm-6">
                <div class="input-group">
                  <input class="form-control mqtt-item-value" value={{ item.value}}>
                  <span class="input-group-addon">{{ item.suffix }}</span>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}